<style>
	.keyboard {
		height: 100%;
		aspect-ratio: 4 / 2.5;
		display: grid;
		grid-template-columns: repeat(3, 1fr);
		grid-template-rows: repeat(3, 1fr);
		gap: 0.5em;
		padding: 0.2em 0 0.5em;
		box-sizing: border-box;
	}
	.key {
		display: flex;
		flex-direction: column;
		border: medium solid #444;
		border-radius: 3px;
		overflow: hidden;
		cursor: pointer;
		user-select: none;
		padding-top: 0.3em;
		font-size: 1.2em;
		color: #aaa;
	}
	.key::before {
		content: attr(data-key);
		text-align: center;
		height: 1.5em;
	}
	.key[data-key='q'] {
		border-color: red;
	}
	.key[data-key='e'] {
		border-color: blue;
	}
	.key.pressed {
		border-color: white;
	}
	.key .content {
		flex: 1;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: 1.25em;
		font-weight: bold;
		padding: 0.1em;
		overflow: hidden;
		color: #fff;
	}
	.key[data-key='q'] .content,
	.key[data-key='e'] .content {
		font-size: 0.85em;
	}
	.key .content svg {
		max-width: 100%;
		max-height: 100%;
		width: auto;
		height: auto;
	}
</style>
<div class="keyboard">
	<div class="key" data-key="1"><div class="content"></div></div>
	<div class="key" data-key="2"><div class="content"></div></div>
	<div class="key" data-key="3"><div class="content"></div></div>
	<div class="key" data-key="q"><div class="content"></div></div>
	<div class="key" data-key="w"><div class="content"></div></div>
	<div class="key" data-key="e"><div class="content"></div></div>
	<div class="key" data-key="a"><div class="content"></div></div>
	<div class="key" data-key="s"><div class="content"></div></div>
	<div class="key" data-key="d"><div class="content"></div></div>
</div>
<script>
	(() => {
		const u = window.pathless;
		['1', '2', '3', 'q', 'w', 'e', 'a', 's', 'd'].forEach((key) => {
			const keyEl = document.querySelector(`.key[data-key="${key}"]`);
			if (!keyEl) return;

			const content = keyEl.querySelector('.content');
			const bind = u.keybinds.get(key);
			if (!bind || (!bind.desc && !['1', '2', '3'].includes(key))) {
				content.innerHTML = '';
				if (bind) bind.el = keyEl;
				return;
			}
			bind.el = keyEl;
			if (['1', '2', '3'].includes(key)) {
				const n = parseInt(key);
				const layout = u.layouts[n - 1];
				if (!layout) return;

				const variantIdx =
					n === 1
						? 0
						: u.layout[0] === n - 1
							? (u.layout[1] + 1) % layout.variants.length
							: 0;

				content.innerHTML = layout.variants[variantIdx].svg;
			} else {
				content.textContent = bind.desc;
			}
		});
	})();
</script>
